defaults:
  - override hydra/sweeper: optuna
  - override hydra/sweeper/sampler: tpe
  - override hydra/launcher: custom_joblib # For multiprocessing with n_jobs > 1

hydra:
  launcher:
    _target_: hydra_plugins.hydra_custom_joblib_launcher.joblib_launcher.JoblibLauncher
  sweeper:
    sampler:
      _target_: optuna.samplers.TPESampler
      seed: 123
      consider_prior: true
      prior_weight: 1.0
      consider_magic_clip: true
      consider_endpoints: false
      n_startup_trials: 10
      n_ei_candidates: 24
      multivariate: false
      warn_independent_sampling: true
    _target_: hydra_plugins.hydra_custom_optuna_sweeper.custom_optuna_sweeper.CustomOptunaSweeper
    direction: maximize # maximize accuracy / n_epochs
#      - maximize
#      - minimize
    study_name: simple_mnist
    storage: sqlite:///simple_mnist.db
    max_trials: 200
    n_jobs: 1
    max_duration_minutes: 15
    min_trials_per_param: 3
    max_trials_per_param: 5

    search_space:
      model.fc1_units:
        type: int
        low: 8
        high: 256
        step: 8
      model.fc2_units:
        type: int
        low: 8
        high: 256
        step: 8
      model.conv1.n_kernels:
        type: int
        low: 2
        high: 12
        step: 1
      model.conv2.n_kernels:
        type: int
        low: 2
        high: 12
        step: 1
      model.conv1.kernel_size:
        type: int
        low: 2
        high: 4
        step: 1
      model.conv2.kernel_size:
        type: int
        low: 2
        high: 4
        step: 1

model:
  conv1:
    kernel_size: 3
    n_kernels: 7
  conv2:
    kernel_size: 3
    n_kernels: 15
  fc1_units: 64
  fc2_units: 64

optimizer:
  lr: 0.001
  momentum: 0.9

n_epochs: 7

train:
  batch_size: 4


test:
  batch_size: 4
